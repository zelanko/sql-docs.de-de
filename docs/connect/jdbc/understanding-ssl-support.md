---
title: Verstehen der Verschlüsselungsunterstützung
description: Hier erfahren Sie, wie Sie sicherstellen, dass der JDBC-Treiber TLS-Verschlüsselung verwendet, um Verbindungen mit einer SQL-Datenbank zu sichern.
ms.custom: ''
ms.date: 09/12/2019
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: vanto
ms.technology: connectivity
ms.topic: conceptual
ms.assetid: 073f3b9e-8edd-4815-88ea-de0655d0325e
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: aa20ac9d4118e5fec4dbaf225d27c9db8257a88f
ms.sourcegitcommit: cb620c77fe6bdefb975968837706750c31048d46
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 07/15/2020
ms.locfileid: "86393118"
---
# <a name="understanding-encryption-support"></a>Verstehen der Verschlüsselungsunterstützung

[!INCLUDE[Driver_JDBC_Download](../../includes/driver_jdbc_download.md)]

Wenn die Anwendung beim Herstellen einer Verbindung mit [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] eine Verschlüsselung anfordert und die Instanz [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] für die Unterstützung von TLS-Verschlüsselung konfiguriert ist, initialisiert [!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)] den TSL-Handshake. Mithilfe des Handshakes können der Server und der Client die Verschlüsselungs- und Kryptografiealgorithmen aushandeln, mit denen Daten geschützt werden sollen. Nach Abschluss des TLS-Handshakes können der Client und der Server die verschlüsselten Daten sicher senden. Während des TLS-Handshakes sendet der Server sein Zertifikat für öffentliche Schlüssel an den Client. Der Aussteller eines Zertifikats für öffentliche Schlüssel wird als Zertifizierungsstelle bezeichnet. Der Client ist dafür verantwortlich zu überprüfen, ob der Client der Zertifizierungsstelle vertraut.  
  
Wenn die Anwendung keine Verschlüsselung anfordert, erzwingt [!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)] die Unterstützung der TLS-Verschlüsselung von [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] nicht. Wenn die Instanz [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] nicht für das Erzwingen der TSL-Verschlüsselung konfiguriert ist, wird ohne Verschlüsselung eine Verbindung hergestellt. Falls die Instanz [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] für das Erzwingen der TSL-Verschlüsselung konfiguriert ist, aktiviert der Treiber automatisch die TSL-Verschlüsselung, wenn er auf einer ordnungsgemäß konfigurierten Java Virtual Machine-Instanz (JVM) ausgeführt wird. Andernfalls wird die Verbindung getrennt, und der Treiber löst einen Fehler aus.  
  
> [!NOTE]  
> Stellen Sie sicher, dass der an **serverName** übergebene Name für eine erfolgreiche TSL-Verbindung exakt dem CN (Common Name, allgemeiner Name) oder dem DNS-Namen im SAN (Subject Alternate Name, alternativer Antragstellername) im Serverzertifikat entspricht.  
>
> Weitere Informationen zum Konfigurieren von TLS für [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] finden Sie unter [Aktivieren von verschlüsselten Verbindungen zur Datenbank-Engine](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).  
  
## <a name="remarks"></a>Bemerkungen

Damit die TSL-Verschlüsselung von Anwendungen verwendet werden kann, hat [!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)] ab Version 1.2 die folgenden Verbindungseigenschaften eingeführt: **encrypt**, **trustServerCertificate**, **trustStore**, **trustStorePassword** und **hostNameInCertificate**. Weitere Informationen zum Festlegen der Verbindungseigenschaften finden Sie unter [Setting the Connection Properties (Festlegen von Verbindungseigenschaften)](../../connect/jdbc/setting-the-connection-properties.md).  
  
 In der folgenden Tabelle wird das Verhalten der Version [!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)] in möglichen TSL-Verbindungsszenarios zusammengefasst. In jedem Szenario werden andere TSL-Verbindungseigenschaften verwendet. Die Tabelle schließt Folgendes ein:  
  
- **blank**: „Die Eigenschaft ist in der Verbindungszeichenfolge nicht vorhanden.“  
  
- **value:** „Die Eigenschaft ist in der Verbindungszeichenfolge vorhanden und ihr Wert ist gültig.“  
  
- **any**: „Es spielt keine Rolle, ob die Eigenschaft in der Verbindungszeichenfolge vorhanden oder ihr Wert gültig ist.“  
  
> [!NOTE]  
> Das gleiche Verhalten trifft auf die [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-Benutzerauthentifizierung und die integrierte Windows-Authentifizierung zu.  
  
| encrypt        | trustServerCertificate | hostNameInCertificate | trustStore | trustStorePassword | Verhalten                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| -------------- | ---------------------- | --------------------- | ---------- | ------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| false oder blank | any                    | any                   | any        | any                | Der [!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)] wird [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] nicht zwingen, die TLS-Verschlüsselung zu unterstützen. Wenn der Server ein selbst signiertes Zertifikat aufweist, initiiert der Treiber den TSL-Zertifikataustausch. Das TSL-Zertifikat wird nicht überprüft, und nur die Anmeldeinformationen (im Anmeldepaket) werden verschlüsselt.<br /><br /> Wenn der Server erfordert, dass der Client TSL-Verschlüsselung unterstützt, initiiert der Treiber den TLS-Zertifikataustausch. Das TSL-Zertifikat wird zwar nicht überprüft, aber die gesamte Kommunikation wird verschlüsselt.                                                                                                                                                                                    |
| true           | true                   | any                   | any        | any                | Der [!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)] verlangt, dass bei [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] die TLS-Verschlüsselung verwendet wird.<br /><br /> Wenn der Server erfordert, dass der Client TLS-Verschlüsselung unterstützt oder der Server die Verschlüsselung unterstützt, initiiert der Treiber den TLS-Zertifikataustausch. Wenn die Eigenschaft **trustServerCertificate** auf „true“ festgelegt ist, überprüft der Treiber das TLS-Zertifikat nicht.<br /><br /> Wenn der Server nicht für die Unterstützung der Verschlüsselung konfiguriert ist, löst der Treiber einen Fehler aus und trennt die Verbindung.                                                                                                                                                                                          |
| true           | false oder blank         | leer                 | leer      | leer              | Der [!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)] verlangt, dass bei [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] die TLS-Verschlüsselung verwendet wird.<br /><br /> Wenn der Server erfordert, dass der Client TLS-Verschlüsselung unterstützt oder der Server die Verschlüsselung unterstützt, initiiert der Treiber den TLS-Zertifikataustausch.<br /><br /> Der Treiber verwendet die in der Verbindungs-URL angegebene Eigenschaft **serverName**, um das TLS-Zertifikat des Servers zu überprüfen. Außerdem werden die Suchregeln der Trust-Manager-Factory verwendet, um den zu verwendenden Zertifikatspeicher zu ermitteln.<br /><br /> Wenn der Server nicht für die Unterstützung der Verschlüsselung konfiguriert ist, löst der Treiber einen Fehler aus und trennt die Verbindung.                                                                             |
| true           | false oder blank         | value                 | leer      | leer              | Der [!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)] verlangt, dass bei [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] die TLS-Verschlüsselung verwendet wird.<br /><br /> Wenn der Server erfordert, dass der Client TLS-Verschlüsselung unterstützt oder der Server die Verschlüsselung unterstützt, initiiert der Treiber den TLS-Zertifikataustausch.<br /><br /> Der Treiber überprüft den subject-Wert des TLS-Zertifikats mithilfe des für die Eigenschaft **hostNameInCertificate** angegebenen Werts.<br /><br /> Wenn der Server nicht für die Unterstützung der Verschlüsselung konfiguriert ist, löst der Treiber einen Fehler aus und trennt die Verbindung.                                                                                                                                                                 |
| true           | false oder blank         | leer                 | value      | value              | Der [!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)] verlangt, dass bei [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] die TLS-Verschlüsselung verwendet wird.<br /><br /> Wenn der Server erfordert, dass der Client TLS-Verschlüsselung unterstützt oder der Server die Verschlüsselung unterstützt, initiiert der Treiber den TLS-Zertifikataustausch.<br /><br /> Der Treiber verwendet den **trustStore**-Eigenschaftswert zum Ermitteln der trustStore-Zertifikatdatei und den **trustStorePassword**-Eigenschaftswert zum Überprüfen der Integrität der trustStore-Datei.<br /><br /> Wenn der Server nicht für die Unterstützung der Verschlüsselung konfiguriert ist, löst der Treiber einen Fehler aus und trennt die Verbindung.                                                                                                                |
| true           | false oder blank         | leer                 | leer      | value              | Der [!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)] verlangt, dass bei [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] die TLS-Verschlüsselung verwendet wird.<br /><br /> Wenn der Server erfordert, dass der Client TLS-Verschlüsselung unterstützt oder der Server die Verschlüsselung unterstützt, initiiert der Treiber den TLS-Zertifikataustausch.<br /><br /> Der Treiber verwendet den **trustStorePassword**-Eigenschaftswert zum Überprüfen der Integrität der trustStore-Standarddatei.<br /><br /> Wenn der Server nicht für die Unterstützung der Verschlüsselung konfiguriert ist, löst der Treiber einen Fehler aus und trennt die Verbindung.                                                                                                                                                                                  |
| true           | false oder blank         | leer                 | value      | leer              | Der [!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)] verlangt, dass bei [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] die TLS-Verschlüsselung verwendet wird.<br /><br /> Wenn der Server erfordert, dass der Client TLS-Verschlüsselung unterstützt oder der Server die Verschlüsselung unterstützt, initiiert der Treiber den TLS-Zertifikataustausch.<br /><br /> Der Treiber verwendet den **trustStore**-Eigenschaftswert, um den Speicherort der trustStore-Datei zu ermitteln.<br /><br /> Wenn der Server nicht für die Unterstützung der Verschlüsselung konfiguriert ist, löst der Treiber einen Fehler aus und trennt die Verbindung.                                                                                                                                                                                                 |
| true           | false oder blank         | value                 | leer      | value              | Der [!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)] verlangt, dass bei [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] die TLS-Verschlüsselung verwendet wird.<br /><br /> Wenn der Server erfordert, dass der Client TLS-Verschlüsselung unterstützt oder der Server die Verschlüsselung unterstützt, initiiert der Treiber den TLS-Zertifikataustausch.<br /><br /> Der Treiber verwendet den **trustStorePassword**-Eigenschaftswert zum Überprüfen der Integrität der trustStore-Standarddatei. Außerdem verwendet der Treiber den Eigenschaftswert **hostNameInCertificate**, um das TLS-Zertifikat zu überprüfen.<br /><br /> Wenn der Server nicht für die Unterstützung der Verschlüsselung konfiguriert ist, löst der Treiber einen Fehler aus und trennt die Verbindung.                                                                   |
| true           | false oder blank         | value                 | value      | leer              | Der [!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)] verlangt, dass bei [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] die TLS-Verschlüsselung verwendet wird.<br /><br /> Wenn der Server erfordert, dass der Client TLS-Verschlüsselung unterstützt oder der Server die Verschlüsselung unterstützt, initiiert der Treiber den TLS-Zertifikataustausch.<br /><br /> Der Treiber verwendet den **trustStore**-Eigenschaftswert, um den Speicherort der trustStore-Datei zu ermitteln. Außerdem verwendet der Treiber den Eigenschaftswert **hostNameInCertificate**, um das TLS-Zertifikat zu überprüfen.<br /><br /> Wenn der Server nicht für die Unterstützung der Verschlüsselung konfiguriert ist, löst der Treiber einen Fehler aus und trennt die Verbindung.                                                                                  |
| true           | false oder blank         | value                 | value      | value              | Der [!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)] verlangt, dass bei [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] die TLS-Verschlüsselung verwendet wird.<br /><br /> Wenn der Server erfordert, dass der Client TLS-Verschlüsselung unterstützt oder der Server die Verschlüsselung unterstützt, initiiert der Treiber den TLS-Zertifikataustausch.<br /><br /> Der Treiber verwendet den **trustStore**-Eigenschaftswert zum Ermitteln der trustStore-Zertifikatdatei und den **trustStorePassword**-Eigenschaftswert zum Überprüfen der Integrität der trustStore-Datei. Außerdem verwendet der Treiber den Eigenschaftswert **hostNameInCertificate**, um das TLS-Zertifikat zu überprüfen.<br /><br /> Wenn der Server nicht für die Unterstützung der Verschlüsselung konfiguriert ist, löst der Treiber einen Fehler aus und trennt die Verbindung. |
  
Wenn die Eigenschaft „encrypt“ auf **TRUE** festgelegt ist, verwendet [!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)] den JSSE-Standardsicherheitsanbieter der JVM-Instanz, um die TLS-Verschlüsselung mit [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] auszuhandeln. Der Standardsicherheitsanbieter unterstützt möglicherweise nicht alle Features, die zum erfolgreichen Aushandeln der TLS-Verschlüsselung erforderlich sind. So ist es beispielsweise möglich, dass die im TSL-Zertifikat für [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] verwendete Größe des öffentlichen RSA-Schlüssels nicht vom Standardsicherheitsanbieter unterstützt wird. In diesem Fall löst der Standardsicherheitsanbieter möglicherweise einen Fehler aus, wodurch der JDBC-Treiber die Verbindung trennt. Sie haben folgende Möglichkeiten, dieses Problem zu beheben:  
  
- Konfigurieren Sie [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] mit einem Serverzertifikat mit einem kleineren öffentlichen RSA-Schlüssel  
  
- Konfigurieren Sie JVM für die Verwendung eines anderen JSSE-Sicherheitsanbieters in der Sicherheitseigenschaftendatei „\<java-home>/lib/security/java.security“.  
  
- Verwenden Sie eine andere JVM.  
  
## <a name="validating-server-tls-certificate"></a>Überprüfen des TSL-Serverzertifikats  

Während des TLS-Handshakes sendet der Server sein Zertifikat für öffentliche Schlüssel an den Client. Der JDBC-Treiber oder Client muss überprüfen, ob das Serverzertifikat von einer Zertifizierungsstelle herausgegeben wurde, der der Client vertraut. Der Treiber erfordert, dass das Serverzertifikat die folgenden Bedingungen erfüllt:  
  
- Das Zertifikat wurde von einer vertrauenswürdigen Zertifizierungsstelle ausgegeben.  
  
- Das Zertifikat muss für die Serverauthentifizierung ausgegeben sein.  
  
- Das Zertifikat ist nicht abgelaufen.  
  
- Der CN (Common Name) im Subjekt oder ein DNS-Name im SAN (Subject Alternate Name, Subjektalternativname) des Zertifikats entspricht genau dem **serverName**-Wert, der in der Verbindungszeichenfolge angegeben ist, oder – falls angegeben – dem Eigenschaftenwert **hostNameInCertificate**.  
  
- Ein DNS-Name kann Platzhalterzeichen enthalten. Der [!INCLUDE[jdbcNoVersion](../../includes/jdbcnoversion_md.md)] unterstützt jedoch keinen Platzhalterabgleich. Das heißt, „abc.com“ entspricht nicht „\*.com“, während „\*.com“ „\*.com“ entspricht.  
  
## <a name="see-also"></a>Weitere Informationen

[Verwenden von Verschlüsselung](../../connect/jdbc/using-ssl-encryption.md)

[Schützen von JDBC-Treiberanwendungen](../../connect/jdbc/securing-jdbc-driver-applications.md)  
